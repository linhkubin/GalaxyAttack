{"version":3,"sources":["assets\\_Game\\Script\\Ship.ts"],"names":[],"mappings":";;;;;AAAA,oBAAoB;AACpB,wEAAwE;AACxE,mBAAmB;AACnB,kFAAkF;AAClF,8BAA8B;AAC9B,kFAAkF;;;;;;;;;;;;;;;;;;;;;AAGlF,gDAAyD;AACzD,yCAAoC;AAE9B,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAG5C;IAAkC,wBAAY;IAA9C;QAAA,qEAuGC;QAhGQ,oBAAc,GAAc,EAAE,CAAC;QAO/B,oBAAc,GAAc,EAAE,CAAC;QAEtC,mBAAmB;QACX,kBAAY,GAAe,EAAE,CAAC;QAK9B,YAAM,GAAY,IAAI,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC,CAAC;QA8CvG,gCAAgC;QAExB,WAAK,GAAW,CAAC,CAAC;;IAiC5B,CAAC;IA5EC,qBAAM,GAAN;QACE,mCAAmC;QACnC,oBAAoB;QACpB,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACrE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QAEpE,IAAI,CAAC,MAAM,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,KAAK,EAAE,EAAE,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC,MAAM,CAAC,CAAC;QAC3F,IAAI,CAAC,YAAY,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC9D,IAAI,CAAC,aAAa,GAAG,IAAI,EAAE,CAAC,IAAI,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAE/D,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC;IAC1C,CAAC;IAGD,wBAAS,GAAT;QACE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,WAAW,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QACtE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;IACvE,CAAC;IAED,MAAM;IAEN,kBAAkB;IACV,2BAAY,GAApB,UAAqB,KAA0B;QAC7C,IAAI,CAAC,WAAW,GAAG,mBAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC;IAClG,CAAC;IAED,iBAAiB;IACT,2BAAY,GAApB,UAAqB,KAA0B;QAC7C,IAAM,MAAM,GAAG,IAAI,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE/D,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAC9E,MAAM,CAAC,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,CAAC;QAEhF,IAAI,CAAC,IAAI,CAAC,QAAQ,GAAG,mBAAS,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;IACpD,CAAC;IAED,4BAA4B;IACpB,4BAAa,GAArB,UAAsB,KAA0B;QAC9C,OAAO,KAAK,CAAC,WAAW,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;IAClF,CAAC;IAMD,qBAAM,GAAN,UAAO,EAAU;QACf,oBAAoB;QACpB,IAAG,IAAI,CAAC,KAAK,IAAI,CAAC,EAAC;YACjB,IAAI,CAAC,KAAK,GAAG,GAAG,CAAC;YACjB,IAAI,CAAC,KAAK,EAAE,CAAC;SACd;QAED,IAAI,CAAC,KAAK,IAAI,EAAE,CAAC;IACnB,CAAC;IAEO,oBAAK,GAAb;QACE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;YAChD,oBAAU,CAAC,KAAK,CAAC,qBAAQ,CAAC,QAAQ,EAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,gBAAgB,EAAE,EAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,KAAK,CAAY,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;SACjI;IACH,CAAC;IAEM,wBAAS,GAAhB;QACE,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC;IAC1C,CAAC;IAEM,uBAAQ,GAAf;IAEA,CAAC;IAEM,sBAAO,GAAd;IAEA,CAAC;IAEM,uBAAQ,GAAf;IAEA,CAAC;IA/FD;QALC,QAAQ,CAAC;YACR,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC;YACf,OAAO,EAAE,gBAAgB;SAC1B,CAAC;gDAEoC;IAOtC;QALC,QAAQ,CAAC;YACR,IAAI,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC;YACf,OAAO,EAAE,gBAAgB;SAC1B,CAAC;gDAEoC;IAdnB,IAAI;QADxB,OAAO;OACa,IAAI,CAuGxB;IAAD,WAAC;CAvGD,AAuGC,CAvGiC,EAAE,CAAC,SAAS,GAuG7C;kBAvGoB,IAAI","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nimport Bullet from \"./Bullet\";\r\nimport SimplePool, { PoolType } from \"./Pool/SimplePool\";\r\nimport Utilities from \"./Utilities\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Ship extends cc.Component {\r\n\r\n  @property({\r\n    type: [cc.Node],\r\n    tooltip: 'bulletPoints_1'\r\n  })\r\n  //list đạn ban đầu\r\n  public bulletPoints_1: cc.Node[] = [];\r\n\r\n  @property({\r\n    type: [cc.Node],\r\n    tooltip: 'bulletPoints_2'\r\n  })\r\n  //list đạn sau khi level up\r\n  public bulletPoints_2: cc.Node[] = [];\r\n\r\n  //list đạn bắn ra  \r\n  private bulletPoints : cc.Node[] = [];\r\n\r\n  // private player: cc.Node;\r\n  private touchOffset: cc.Vec2;\r\n\r\n  private screen: cc.Vec2 = new cc.Vec2(cc.view.getVisibleSize().width, cc.view.getVisibleSize().height);\r\n  private clampHorizon: cc.Vec2;// = new cc.Vec2(-0.5, 0.5).mul(this.screen.x);\r\n  private clampVertical: cc.Vec2;// = new cc.Vec2(-0.5, 0.5).mul(this.screen.y);\r\n  \r\n\r\n  onLoad() {\r\n    // this.player = cc.find('player');\r\n    //set up move object\r\n    this.node.on(cc.Node.EventType.TOUCH_START, this.onTouchBegan, this);\r\n    this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMoved, this);\r\n\r\n    this.screen = new cc.Vec2(cc.view.getVisibleSize().width, cc.view.getVisibleSize().height);\r\n    this.clampHorizon = new cc.Vec2(-0.5, 0.5).mul(this.screen.x);\r\n    this.clampVertical = new cc.Vec2(-0.5, 0.5).mul(this.screen.y);\r\n\r\n    this.bulletPoints = this.bulletPoints_1;\r\n  }\r\n\r\n  \r\n  onDestroy() {\r\n    this.node.off(cc.Node.EventType.TOUCH_START, this.onTouchBegan, this);\r\n    this.node.off(cc.Node.EventType.TOUCH_MOVE, this.onTouchMoved, this);\r\n  }\r\n\r\n  //Move\r\n\r\n  //bat dau an xuong\r\n  private onTouchBegan(event: cc.Event.EventTouch)/*: boolean*/ {\r\n    this.touchOffset = Utilities.vec3ToVec2(this.node.position).subtract(this.getMousePoint(event));\r\n  }\r\n\r\n  //di chuyen chuot\r\n  private onTouchMoved(event: cc.Event.EventTouch) {\r\n    const newPos = this.getMousePoint(event).add(this.touchOffset);\r\n\r\n    newPos.x = cc.misc.clampf(newPos.x, this.clampHorizon.x, this.clampHorizon.y);\r\n    newPos.y = cc.misc.clampf(newPos.y, this.clampVertical.x, this.clampVertical.y);\r\n    \r\n    this.node.position = Utilities.vec2ToVec3(newPos);\r\n  }\r\n\r\n  //lay vi tri chuot bam xuong\r\n  private getMousePoint(event: cc.Event.EventTouch): cc.Vec2{\r\n    return event.getLocation().sub(cc.v2(this.screen.x * 0.5, this.screen.y * 0.5));\r\n  }\r\n\r\n  //------------------------------\r\n\r\n  private timer: number = 0;\r\n\r\n  update(dt: number) {\r\n    //moi 0.5s bắn 1 lần\r\n    if(this.timer <= 0){\r\n      this.timer = 0.5;\r\n      this.shoot();\r\n    }\r\n\r\n    this.timer -= dt;\r\n  }\r\n\r\n  private shoot(){\r\n    for (let i = 0; i < this.bulletPoints.length; i++) {\r\n      (SimplePool.spawn(PoolType.Bullet_1,  this.bulletPoints[i].getWorldPosition(),this.bulletPoints[i].angle) as Bullet).onInit(10);\r\n    }\r\n  }\r\n\r\n  public onPowerUp(): void {\r\n    this.bulletPoints = this.bulletPoints_2;\r\n  }\r\n\r\n  public onShield(): void {\r\n    \r\n  }\r\n\r\n  public onStart(): void {\r\n    \r\n  }\r\n\r\n  public onFinish(): void {\r\n    \r\n  }\r\n}\r\n"]}